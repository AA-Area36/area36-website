# Fix: Missing `event_to_types` Table

## Problem
The query `select "event_id", "type" from "event_to_types"` is failing because the `event_to_types` table doesn't exist in the D1 database.

## Root Cause
The migration `0006_event_features.sql` (which creates the `event_to_types` junction table) has not been applied to the database.

## Evidence
- **Schema defines the table**: `lib/db/schema.ts:120-129` defines `eventToTypes`
- **Migration exists**: `lib/db/migrations/0006_event_features.sql:21-34` creates the table
- **Query is correct**: `app/events/page.tsx:39-41` runs a valid query
- **Error indicates table missing**: D1/SQLite throws error when table doesn't exist

## Solution
Apply the missing migration to the D1 database.

### Files Involved
- `lib/db/migrations/0006_event_features.sql` - Migration to apply
- No code changes needed

### Steps (Local Development)
1. Run the migration against local D1:
   ```bash
   pnpm wrangler d1 execute area36-events --local --file=./lib/db/migrations/0006_event_features.sql
   ```

2. Verify the table was created:
   ```bash
   pnpm wrangler d1 execute area36-events --local --command="SELECT name FROM sqlite_master WHERE type='table' AND name='event_to_types'"
   ```

3. Restart the dev server and test the events page

## Verification
1. Run the dev server: `pnpm dev`
2. Navigate to the events page
3. Confirm no database errors and events load correctly

## Notes
- The migration also creates:
  - `event_flyers` table
  - `recording_folders` table
  - TBD flag columns on `events` table
  - Migrates existing event types to the junction table
- If you've already applied parts of `0006`, you may need to run the SQL statements individually
